## **Логическая модель базы данных Onlearn**

| Сущность | Таблица БД | Поле | Смысл поля | Тип данных |
|---|---|---|---|---|
| **Пользователь** | `users` | `id` | Уникальный идентификатор пользователя | UUID |
| | | `email` | Адрес электронной почты (логин) | VARCHAR(255) |
| | | `name` | Имя и фамилия пользователя | VARCHAR(100) |
| | | `role` | Роль пользователя (студент, преподаватель, администратор) | ENUM('student', 'teacher', 'admin') |
| | | `created_at` | Дата и время регистрации | TIMESTAMP |
| **Профиль** | `profiles` | `id` | Уникальный идентификатор профиля | UUID |
| | | `user_id` | Ссылка на пользователя | UUID |
| | | `avatar_url` | Ссылка на аватар пользователя | VARCHAR(500) |
| | | `bio` | Биография пользователя | TEXT |
| | | `preferences` | Настройки пользователя в формате JSON | JSONB |
| **Курс** | `courses` | `id` | Уникальный идентификатор курса | UUID |
| | | `title` | Название курса | VARCHAR(200) |
| | | `description` | Подробное описание курса | TEXT |
| | | `category` | Категория курса (программирование, дизайн и т.д.) | VARCHAR(100) |
| | | `level` | Уровень сложности курса | ENUM('beginner', 'intermediate', 'advanced') |
| | | `teacher_id` | Идентификатор преподавателя (создателя курса) | UUID |
| | | `duration_hours` | Продолжительность курса в часах | INTEGER |
| | | `rating` | Рейтинг курса (средняя оценка) | DECIMAL(3,2) |
| | | `is_published` | Флаг публикации курса (true/false) | BOOLEAN |
| **Урок** | `lessons` | `id` | Уникальный идентификатор урока | UUID |
| | | `course_id` | Ссылка на курс, к которому принадлежит урок | UUID |
| | | `title` | Название урока | VARCHAR(200) |
| | | `description` | Описание содержания урока | TEXT |
| | | `content_url` | Ссылка на контент урока (видео, текст) | VARCHAR(500) |
| | | `duration_minutes` | Продолжительность урока в минутах | INTEGER |
| | | `order_index` | Порядковый номер урока в курсе | INTEGER |
| | | `type` | Тип урока (видео, текст, презентация) | ENUM('video', 'text', 'presentation', 'interactive') |
| **Материал** | `materials` | `id` | Уникальный идентификатор материала | UUID |
| | | `lesson_id` | Ссылка на урок, к которому прикреплен материал | UUID |
| | | `title` | Название материала | VARCHAR(200) |
| | | `type` | Тип материала (PDF, видео, изображение и т.д.) | ENUM('pdf', 'video', 'image', 'code', 'presentation', 'archive') |
| | | `file_url` | Ссылка на файл материала | VARCHAR(500) |
| | | `file_size` | Размер файла в байтах | BIGINT |
| **Тест** | `tests` | `id` | Уникальный идентификатор теста | UUID |
| | | `lesson_id` | Ссылка на урок, к которому прикреплен тест | UUID |
| | | `title` | Название теста | VARCHAR(200) |
| | | `description` | Описание теста | TEXT |
| | | `passing_score` | Проходной балл (минимальный процент для зачета) | INTEGER |
| | | `attempt_limit` | Максимальное количество попыток | INTEGER |
| | | `time_limit_minutes` | Ограничение по времени в минутах | INTEGER |
| | | `is_published` | Флаг публикации теста | BOOLEAN |
| **Запись на курс** | `enrollments` | `id` | Уникальный идентификатор записи | UUID |
| | | `user_id` | Ссылка на пользователя (студента) | UUID |
| | | `course_id` | Ссылка на курс | UUID |
| | | `status` | Статус записи (активна, завершена, отменена) | ENUM('active', 'completed', 'dropped', 'pending') |
| | | `enrolled_at` | Дата и время записи на курс | TIMESTAMP |
| | | `completed_at` | Дата и время завершения курса | TIMESTAMP |
| **Прогресс** | `progress` | `id` | Уникальный идентификатор записи прогресса | UUID |
| | | `enrollment_id` | Ссылка на запись на курс | UUID |
| | | `completed_lessons` | Количество пройденных уроков | INTEGER |
| | | `completed_tests` | Количество пройденных тестов | INTEGER |
| | | `total_lessons` | Общее количество уроков в курсе | INTEGER |
| | | `total_tests` | Общее количество тестов в курсе | INTEGER |
| | | `progress_percentage` | Процент выполнения курса | DECIMAL(5,2) |
| | | `last_activity_at` | Дата и время последней активности | TIMESTAMP |
| **Сертификат** | `certificates` | `id` | Уникальный идентификатор сертификата | UUID |
| | | `enrollment_id` | Ссылка на запись на курс | UUID |
| | | `user_id` | Ссылка на пользователя | UUID |
| | | `course_id` | Ссылка на курс | UUID |
| | | `issued_at` | Дата и время выдачи сертификата | TIMESTAMP |
| | | `certificate_url` | Ссылка на файл сертификата | VARCHAR(500) |
| | | `verification_code` | Уникальный код для проверки подлинности | VARCHAR(100) |
| **Тема форума** | `forum_threads` | `id` | Уникальный идентификатор темы | UUID |
| | | `course_id` | Ссылка на курс | UUID |
| | | `user_id` | Ссылка на пользователя (автора темы) | UUID |
| | | `lesson_id` | Ссылка на урок (если тема связана с уроком) | UUID |
| | | `title` | Заголовок темы | VARCHAR(200) |
| | | `content` | Содержание темы | TEXT |
| | | `is_pinned` | Флаг закрепления темы (важная тема) | BOOLEAN |
| | | `is_closed` | Флаг закрытия темы (комментирование запрещено) | BOOLEAN |
| | | `created_at` | Дата и время создания темы | TIMESTAMP |
| **Комментарий** | `comments` | `id` | Уникальный идентификатор комментария | UUID |
| | | `thread_id` | Ссылка на тему форума | UUID |
| | | `user_id` | Ссылка на пользователя (автора комментария) | UUID |
| | | `parent_comment_id` | Ссылка на родительский комментарий (для вложенных комментариев) | UUID |
| | | `content` | Текст комментария | TEXT |
| | | `is_edited` | Флаг редактирования комментария | BOOLEAN |
| | | `created_at` | Дата и время создания комментария | TIMESTAMP |
| **Попытка теста** | `test_attempts` | `id` | Уникальный идентификатор попытки | UUID |
| | | `test_id` | Ссылка на тест | UUID |
| | | `user_id` | Ссылка на пользователя | UUID |
| | | `enrollment_id` | Ссылка на запись на курс | UUID |
| | | `score` | Набранные баллы | INTEGER |
| | | `max_score` | Максимальный балл за тест | INTEGER |
| | | `is_passed` | Флаг успешного прохождения теста | BOOLEAN |
| | | `started_at` | Дата и время начала попытки | TIMESTAMP |
| | | `completed_at` | Дата и время завершения попытки | TIMESTAMP |
| | | `attempt_number` | Номер попытки (1, 2, 3...) | INTEGER |
| | | `answers_data` | Данные ответов пользователя в формате JSON | JSONB |
